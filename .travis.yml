# Travis CI for building ArgumentReader
# --------------------------------------------

language: csharp
solution: ArgumentsExtended.sln
mono: none
dotnet: 3.1.301

addons:
  apt:
    packages:
      - zip

install:
  - dotnet restore

script:
  - dotnet test

before_deploy:
  - dotnet build -c Release -o ./output
  - dotnet nuget pack ArgumentsLib/bin/debug/CommandLineArgumentsLib.1.0.0.nupkg -version $TEST_VERSION -Verbosity detailed
  - dotnet nuget pack ArgumentsLib/bin/debug/CommandLineArgumentsLib.1.0.0.nupkg $NUGET_ORG_KEY -Verbosity detailed -Source nuget.org
  - zip ArgumentReader.zip ./output/*Lib.dll

deploy:
  provider: releases
  overwrite: true
  api_key: $GITHUB_TOKEN
  file:
    - "./ArgumentReader.zip"
    - "./output/BooleanMarshalerLib.dll"
    - "./output/IntegerMarshalerLib.dll"
    - "./output/DoubleMarshalerLib.dll"
    - "./output/StringMarshalerLib.dll"
  skip_cleanup: true
  on:
    tags: true

